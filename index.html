<!DOCTYPE html>
<html lang="zh-cn">
	<head>
		<!-- version 3.0 -->
		<meta charset="utf-8">
		<link type="text/css" rel="stylesheet" href="additional_files/bootstrap.simplify.min.css">
		<link type="text/css" rel="stylesheet" href="additional_files/sh_typical.min.css">
		<link type="text/css" rel="stylesheet" href="additional_files/pgmain.min.css">
		<title>OI 中转站 - 做题记录</title>
		<script src="additional_files/jquery.min.js"></script>
		<script src="additional_files/basic.min.js"></script>
		<script src="additional_files/file.min.js"></script>
		<script src="additional_files/sort.min.js"></script>
		<script src="additional_files/js_natsort.js"></script>
		<script>
			// document loaded
			$(document).ready(function () {
				updTime(); setInterval(updTime, 250);
				if (getStorage('marquee') === 'on') $("#intro").show().get(0).start();

				curLocation = parseSearch('curLoc', '');
				$('#pLocation').html('当前位置: ' + getDisplay(curLocation));

				curROrder = getStorage('srtRec') || 'n';
				curPage = parseInt(parseSearch('page', '1'));

				$.get('records/tot.cfg', parseRecords);

				$('#btnMarquee').click(function (){
					var $mar = $('#intro');
					if ($mar.is(':hidden')) {$mar.show().get(0).start(); setStorage('marquee', 'on');}
					else {$mar.hide(); setStorage('marquee', 'off');}
				});

				var $curLoc = $('input[name="curLoc"]');
				$('#form0 input:submit').click(function () {
					$curLoc.val($(this).data('location'));
					$('#form0').submit();
				});

				$('#form1 input:button').click(function () {
					var p = $(this).val(), q;
					if (isNaN(p))
						switch(p){
							case '>': p = curPage + 1; break;
							case '<': p = curPage - 1; break;
							case '\u00bb': p = totPage; break;
							case '\u00ab': p = 1; break;
						}
					$('#selPage').val(p);
					$curLoc.val(curLocation);
					$('#form1').submit();
				});

				$('#selPage').blur(function () {
					var p = parseInt(this.value);
					if (p < 1 || p > totPage) {this.value = curPage.toString(); return;}
					if (p === curPage) return;
					$curLoc.val(curLocation);
					$('#form1').submit();
				});

				$('#selPage').keypress(function (e) {
					if (e.which === 13 || e.keyCode === 13){
						var p = parseInt(this.value);
						if(p < 1 || p > totPage) return alert('你都输入的些什么呀，认真点！'), false;
						$('#form1 input[name="curLoc"]').val(curLocation);
					}
				});

				$('.sortlink').click(function () {
					var t = $(this.parentNode).index(), s;
					if (t != 2) {
						s = getSortChar(t);
						$('#recTable > tbody').empty();
						if (s === curROrder) {curROrder += 'r'; tableReverse();}
						else if (s + 'r' === curROrder) {curROrder = s; tableReverse();}
						else {curROrder = s; sortTable(s);}
						$('#recTable').append(Rows.slice((curPage - 1) * RECORDS_PER_PAGE, curPage * RECORDS_PER_PAGE));
						setStorage('srtRec', curROrder);
					}	
				});

				$('#motto').fadeTo(2000, 1, function () {$(this).css('opacity', '');});
			});

			function pagination() {
				if (totPage <= 1) return $('#form1').hide();
				$('#selPage').val(curPage).attr('max', totPage);
				$('#pgN1').val(curPage + 1);
				$('#pgN2').val(curPage + 2);
				$('#pgN3').val(curPage + 3);
				$('#pgP1').val(curPage - 1);
				$('#pgP2').val(curPage - 2);
				$('#pgP3').val(curPage - 3);
				if (curPage <= 3) $('#pgP3').hide();
				if (curPage <= 2) $('#pgP2').hide();
				if (curPage <= 1) $('#pgP1, #pgPrev, #pgFirst').hide();
				if (curPage >= totPage - 2) $('#pgN3').hide();
				if (curPage >= totPage - 1) $('#pgN2').hide();
				if (curPage >= totPage) $('#pgN1, #pgNext, #pgLast').hide();
			}
		</script>
	</head>
	<body>
		<div class="title">
			<div class="opacity-3 flex" style="height: 160px">
				<div style="width: 100%">
					<h2 class="cen">OI 中转站 - 做题记录</h2>
					<p class="cen" id="dispTime">当前时间: 2018-7-31 12:00:00</p>
					<p class="ri" id="motto" style="opacity: 0; margin-top: -20px">stably, continuously, periodically.</p>
				</div>
			</div>
		</div>
		<div class="dmarquee" style="height: 25px">
			<button class="button" id="btnMarquee" style="float: left">开启/关闭字幕</button>
			<div style="overflow: hidden">
				<marquee id="intro" scrollamount="1000" style="color: #999; display: none;">bestFy is the cutest !</marquee>
			</div>
		</div>
		<div class="main">
			<div class="opacity-4 padding" style="min-height: 1344px">
				<div class="cen big-button">
					<button>做题记录</button><button onclick="location.href='tools.html'">小工具</button><button onclick="location.href='templates.html'">模板</button><button onclick="location.href='memos.html'">便笺</button>
				</div>
				<fieldset>
					<legend>做题记录</legend>
					<form id="form0"><p>
						<input name="curLoc" type="hidden" />
						<input value="全部" type="submit" data-location="" /><input value="Lydsy" type="submit" data-location="Lydsy" /><input value="洛谷" type="submit" data-location="Luogu" /><input value="Vijos" type="submit" data-location="Vijos" /><input value="HDU" type="submit" data-location="HDU" /><input value="POJ" type="submit" data-location="POJ" /><input value="UOJ" type="submit" data-location="UOJ" /><input value="LibreOJ" type="submit" data-location="LibreOJ" /><input value="SimpleOJ/StupidOJ" type="submit" data-location="SOJ" /><input value="Codeforces" type="submit" data-location="Codeforces" /><input value="Codechef" type="submit" data-location="Codechef" /><input value="SPOJ" type="submit" data-location="SPOJ" /><input value="本地" type="submit" data-location="Local" /><input value="其它 OJ" type="submit" data-location="Unknown" />
					</p></form>
					<p id="pLocation">当前位置: 全部</p>
					<table class="cen main-table" id="recTable" style="width: 100%">
						<thead>
							<tr>
								<th style="width: 8%"><span class="sortlink">记录编号</span></th>
								<th style="width: 19%"><span class="sortlink">题目编号</span></th>
								<th style="width: 11%">题解/代码链接</th>
								<th style="width: 18%"><span class="sortlink">AC 时间</span></th>
								<th style="width: 8%"><span class="sortlink">算法难度</span></th>
								<th style="width: 8%"><span class="sortlink">代码难度</span></th>
								<th style="width: 28%"><span class="sortlink">主要算法</span></th>
							</tr>
						</thead>
						<tbody>
						</tbody>
					</table>
					<p id="recTotal" class="cen">请稍等，写个 FFT 就加载完毕啦！</p>
					<form id="form1"><p>页码：<input name="curLoc" type="hidden" value="">
						<input id="pgFirst" value="&laquo;" type="button" /><input id="pgPrev" value="&lt;" type="button" /><input id="pgP3" value="-2" type="button" /><input id="pgP2" value="-1" type="button" /><input id="pgP1" value="0" type="button" />
						<input id="selPage" name="page" value="1" type="number" min="1" max="1000000" class="cen" style="width: 50px; height: 21px" />
						<input id="pgN1" value="2" type="button" /><input id="pgN2" value="3" type="button" /><input id="pgN3" value="4" type="button" /><input id="pgNext" value="&gt;" type="button" /><input id="pgLast" value="&raquo;" type="button" />
					</p></form>
				</fieldset>
			</div>
		</div>
	</body>
</html>
