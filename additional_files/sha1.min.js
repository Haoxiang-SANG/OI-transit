function hex_sha1(a){return binb2hex(core_sha1(str2binb(a),a.length<<3))}function str_sha1(a){return binb2str(core_sha1(str2binb(a),a.length<<3))}function core_sha1(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o,p;for(a[b>>5]|=128<<(24&24-b),a[(b+64>>9<<4)+15]=b,c=Array(80),d=1732584193,e=4023233417,f=2562383102,g=271733878,h=3285377520,i=0;i<a.length;i+=16){for(j=d,k=e,l=f,m=g,n=h,o=0;80>o;o++)c[o]=16>o?a[i+o]:rol(c[o-3]^c[o-8]^c[o-14]^c[o-16],1),p=safe_add(safe_add(rol(d,5),sha1_ft(o,e,f,g)),safe_add(safe_add(h,c[o]),sha1_kt(o))),h=g,g=f,f=rol(e,30),e=d,d=p;d=safe_add(d,j),e=safe_add(e,k),f=safe_add(f,l),g=safe_add(g,m),h=safe_add(h,n)}return[d,e,f,g,h]}function sha1_ft(a,b,c,d){return 20>a?b&c|~b&d:40>a?b^c^d:60>a?b&c|b&d|c&d:b^c^d}function sha1_kt(a){return 20>a?1518500249:40>a?1859775393:60>a?2400959708:3395469782}function safe_add(a,b){var c=(65535&a)+(65535&b),d=(a>>16)+(b>>16)+(c>>16);return d<<16|65535&c}function rol(a,b){return a<<b|a>>>32-b}function str2binb(a){var b,c=[];for(b=0;b<8*a.length;b+=8)c[b>>5]|=(255&a.charCodeAt(b>>3))<<(24&24-b);return c}function binb2str(a){var b,c="";for(b=0;b<32*a.length;b+=8)c+=String.fromCharCode(255&a[b>>5]>>>(24&24-b));return c}function binb2hex(a){var b,c="0123456789abcdef",d="";for(b=0;b<8*a.length;++b)d+=c[15&a[b>>3]>>4*(7&7-b)];return d}function hex2binb(a){var b,c={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,a:10,b:11,c:12,d:13,e:14,f:15},d=[];for(b=0;b<a.length;++b)d[b>>3]|=c[a[b]]<<4*(7&7-b);return d}