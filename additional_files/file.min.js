!function(a){"use strict";function h(a){var c,d,f,g,b=this.id;for(titleArr[b]=$("title",a).text(),f=$("<h3 />").attr("id",tmpArr[b]).html(titleArr[b]+" [#"+tmpArr[b]+"]:"),d=$("pre",a).prop("outerHTML"),g=$("<div />").html(d).attr("data-id",b),c=b-1;c>=0&&!e[c];--c);$("#templates>div"+(~c?"[data-id="+c+"]":".cen")).after(g).after(f),e[b]=!0}var c,d,e,f={};a.setFileConfig=function(a,b){f[a]=b},a.parseRecords=function(a){var b,d,e,i,j,k,l,g=0,h=0;for(Rows=[],c=a.split("\n"),b=0;b<c.length;++b)if(c[b]){if(e=c[b].replace(/[\f\n\r\v]/g,"").split("|"),5!==e.length)continue;if(++h,!(i=OJMatch(curLocation,d=e[0])))continue;if(f.tag&&!~(";"+html2Text(e[4])+";").indexOf(";"+f.tag+";"))continue;j=$("<tr />"),j.append(k=$("<td />").data("id",h-1)),j.append(k=$("<td />").html(i)),l=$('<a href="records/'+encodeURIComponent(d)+'.html" target="_blank">链接</a>'),j.append(k=$("<td />").append(l)),j.append(k=$("<td />").html(e[1])),j.append(k=$("<td />").html(e[2])),j.append(k=$("<td />").html(e[3])),j.append(k=$("<td />").html(highlightTags(e[4]))),Rows.push(j.get(0)),++g}for(b=0;b<Rows.length;++b)k=$(Rows[b].cells[0]),k.html(h-k.data("id")).removeData();"nr"===curROrder?tableReverse():"n"!==curROrder&&sortTable(curROrder),totPage=Math.ceil(g/RECORDS_PER_PAGE),curPage>=1?curPage>totPage&&(curPage=totPage):curPage=1,$("#recTable").append(Rows.slice((curPage-1)*RECORDS_PER_PAGE,curPage*RECORDS_PER_PAGE)),$("#recTotal").html("统计："+(g?(curLocation||f.tag?"当前位置":"")+"共有 "+g+" 条记录":"怎么一道题都还没有啊，快点做题了！")),pagination()},a.getTemplates=function(a){tmpArr=a.split("\n"),titleArr=[],e=[];var b,c;for(b in tmpArr){if(c=tmpArr[b]=tmpArr[b].replace(/[\f\n\r\v]/g,""),!c.length)return;$.ajax("templates/"+c+".xml",{type:"GET",dataType:"xml",id:parseInt(b),success:h})}},a.parseMemos=function(a){var b,c,e,f,h,i,j,g=0;for(Rows=[],d=a.split("\n"),b=0;b<d.length;++b)if(d[b]){if(f=d[b].replace(/[\f\n\r\v]/g,"").split("|"),4!==f.length)continue;e=f[0],h=$("<tr />"),h.append(i=$("<td />").data("id",b)),h.append(i=$("<td />").html(f[0])),h.append(i=$("<td />")),h.append(i=$("<td />").html(f[1])),h.append(i=$("<td />").html(f[2])),h.data("priority",parseInt(f[3])),Rows.push(h.get(0)),++g}for(b=0;b<Rows.length;++b)i=$(Rows[b].cells[0]),i.html(c=g-i.data("id")).removeData(),i=$(Rows[b].cells[2]),j=$('<a href="memos/'+c+'.html" target="_blank">链接</a>'),i.append(j);for(Rows.sort(function(a,b){return $(b).data("priority")-$(a).data("priority")||+b.cells[0].innerText-+a.cells[0].innerText}),b=0;b<Rows.length;++b)$(Rows[b]).removeData();totPage=Math.ceil(g/RECORDS_PER_PAGE),curPage>=1?curPage>totPage&&(curPage=totPage):curPage=1,$("#memTable").append(Rows.slice((curPage-1)*MEMOS_PER_PAGE,curPage*MEMOS_PER_PAGE)),$("#memTotal").html("统计: 共 "+g+" 份便笺"),pagination()},a.parseRanklist=function(a){var b,c,d,e,f;if("OK"===a.status){a=a.result,Rows=[];for(b in a)d=$("<tr />"),c=a[b].rating,f=$('<a class="user '+(c>=3e3?"legendary":c>=2400?"red":c>=2100?"orange":c>=1900?"violet":c>=1600?"blue":c>=1400?"cyan":c>=1200?"green":"gray")+'" href="http://codeforces.com/profile/'+a[b].handle+'" target="_blank">'+a[b].handle+"</a>"),d.append(e=$("<td />").append(f)),d.append(e=$("<td />").html(a[b].firstName)),d.append(e=$("<td />").html(a[b].lastName)),d.append(e=$("<td />").html(a[b].rating)),d.append(e=$("<td />").html(a[b].maxRating)),c=new Date(1e3*a[b].lastOnlineTimeSeconds),d.append(e=$("<td />").html(dateFormat(c))),f=(c=getFL(a[b].handle))?$('<a href="'+c+'" target="_blank">'+c+"</a>"):null,d.append(e=$("<td />").append(f)),Rows.push(d.get(0));$("#rankTable").append(Rows)}}}(window?window:this);