!function(a){"use strict";function b(a){var b,c,e,f,g=this.id;for(titleArr[g]=$("title",a).text(),e=$("<h3 />").attr("id",tmpArr[g]).html(titleArr[g]+" [#"+tmpArr[g]+"]:"),c=$("pre",a).prop("outerHTML"),f=$("<div />").html(c).attr("data-id",g),b=g-1;b>=0&&!d[b];--b);$("#templates>div"+(~b?"[data-id="+b+"]":".cen")).after(f).after(e),d[g]=true}var c,d,e={};a.setFileConfig=function(a,b){e[a]=b},a.parseRecords=function(a){var b,c,d,f,g,h,i=0,j=a.split("\n").map(x=>x.replace(/[\f\r\v]/g,"").split("|")).filter(x=>x.length===5);for(Rows=[],b=0;b<j.length;++b)c=j[b].concat(""+(j.length-b)),d=recordMatch(c,curLocation,e),d.length&&(f=$("<tr />"),f.append(g=$("<td />").html(d[0])).append(g=$("<td />").html(d[1])).append(g=$("<td />").append(h=$('<a href="records/'+encodeURIComponent(c[0])+'.html" target="_blank">链接</a>'))).append(g=$("<td />").html(c[1])).append(g=$("<td />").html(c[2])).append(g=$("<td />").html(c[3])).append(g=$("<td />").html(d[2])),Rows.push(f.get(0)),++i);sortTable(curROrder),totPage=Math.ceil(i/RECORDS_PER_PAGE),curPage>=1?curPage>totPage&&(curPage=totPage):curPage=1,$("#recTable").append(Rows.slice((curPage-1)*RECORDS_PER_PAGE,curPage*RECORDS_PER_PAGE)),$("#recTotal").html("统计："+(i?(curLocation||e.tag||e.search?"当前位置":"")+"共有 "+i+" 条记录":"怎么一道题都还没有啊，快点做题了！")),pagination()},a.getTemplates=function(a){tmpArr=a.split("\n"),titleArr=[],d=[];var c,e;for(c in tmpArr){if(e=tmpArr[c]=tmpArr[c].replace(/[\f\n\r\v]/g,""),!e.length)return;$.ajax("templates/"+e+".xml",{type:"GET",dataType:"xml",id:parseInt(c),success:b})}},a.parseMemos=function(a){var b,d,e,f,g,h,i,j=0;for(Rows=[],c=a.split("\n"),b=0;b<c.length;++b)if(c[b]){if(f=c[b].replace(/[\f\n\r\v]/g,"").split("|"),4!==f.length)continue;e=f[0],g=$("<tr />"),g.append(h=$("<td />").data("id",b)),g.append(h=$("<td />").html(f[0])),g.append(h=$("<td />")),g.append(h=$("<td />").html(f[1])),g.append(h=$("<td />").html(f[2])),g.data("priority",parseInt(f[3])),Rows.push(g.get(0)),++j}for(b=0;b<Rows.length;++b)h=$(Rows[b].cells[0]),h.html(d=j-h.data("id")).removeData(),h=$(Rows[b].cells[2]),i=$('<a href="memos/'+d+'.html" target="_blank">链接</a>'),h.append(i);for(Rows.sort(function(a,b){return $(b).data("priority")-$(a).data("priority")||+b.cells[0].innerText-+a.cells[0].innerText}),b=0;b<Rows.length;++b)$(Rows[b]).removeData();totPage=Math.ceil(j/RECORDS_PER_PAGE),curPage>=1?curPage>totPage&&(curPage=totPage):curPage=1,$("#memTable").append(Rows.slice((curPage-1)*MEMOS_PER_PAGE,curPage*MEMOS_PER_PAGE)),$("#memTotal").html("统计: 共 "+j+" 份便笺"),pagination()},a.parseRanklist=function(a){var b,c,d,e,f;if("OK"===a.status){a=a.result,Rows=[];for(b in a)d=$("<tr />"),c=a[b].rating,f=$('<a class="user '+(c>=3e3?"legendary":c>=2400?"red":c>=2100?"orange":c>=1900?"violet":c>=1600?"blue":c>=1400?"cyan":c>=1200?"green":"gray")+'" href="http://codeforces.com/profile/'+a[b].handle+'" target="_blank">'+a[b].handle+"</a>"),d.append(e=$("<td />").append(f)),d.append(e=$("<td />").html(a[b].firstName)),d.append(e=$("<td />").html(a[b].lastName)),d.append(e=$("<td />").html(a[b].rating)),d.append(e=$("<td />").html(a[b].maxRating)),c=new Date(1e3*a[b].lastOnlineTimeSeconds),d.append(e=$("<td />").html(dateFormat(c))),f=(c=getFL(a[b].handle))?$('<a href="'+c+'" target="_blank">'+c+"</a>"):null,d.append(e=$("<td />").append(f)),Rows.push(d.get(0));$("#rankTable > tbody").empty().append(Rows)}}}(window?window:this);